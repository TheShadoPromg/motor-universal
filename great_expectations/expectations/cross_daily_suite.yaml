expectation_suite_name: cross_daily_suite
expectations:
  - expect_table_columns_to_match_set:
        column_set:
          [
            "fecha",
            "numero",
            "score_cruzado",
            "oportunidades_total",
            "activaciones_total",
            "combinaciones_activas",
            "detalle_cruzado",
          ]

  - expect_column_values_to_not_be_null:
        column: fecha

  - expect_column_values_to_match_regex:
        column: numero
        regex: "^[0-9]{2}$"

  - expect_column_values_to_be_between:
        column: score_cruzado
        min_value: 0.0
        max_value: 1.0

  - expect_column_values_to_be_between:
        column: oportunidades_total
        min_value: 0
        mostly: 1.0

  - expect_column_values_to_be_between:
        column: activaciones_total
        min_value: 0
        mostly: 1.0

  - expect_column_pair_values_a_to_be_greater_than_b:
        column_A: oportunidades_total
        column_B: activaciones_total
        or_equal: true
        ignore_row_if: either_value_is_missing

  - expect_column_values_to_be_between:
        column: combinaciones_activas
        min_value: 0
        mostly: 1.0

  - expect_column_values_to_not_be_null:
        column: detalle_cruzado

meta:
    notes: "Valida columnas principales del score cruzado diario y garantiza que activaciones â‰¤ oportunidades."
